{% extends 'base.html' %} {% block content %}

<section class="section has-background-info has-text-warning">
  <p class="title has-text-warning">Welcome to the Fair Share election Tracker (FaST)</p>
  <p>Select a race below to see detailed data</p>
</section>

<div class="liveUpdate">{% include 'aplet/liveUpdate.html' %}</div>

<style>
  .progress {
    height: 1.5em;
    width: 100%;
    position: relative;
  }
  .progress-bar {
    float: left;
  }
  .progress:before {
    content: attr(data-label);
    position: absolute;
    text-align: center;
    left: 0;
    right: 0;
  }
  .progress .value {
    display: inline-block;
    height: 100%;
  }

  #tabs-with-content .tabs:not(:last-child) {
    margin-bottom: 0;
  }

  #tabs-with-content .tab-content {
    padding: 1rem;
    display: none;
  }

  #tabs-with-content .tab-content.is-active {
    display: block;
  }
</style>

<script>
  let tabsWithContent = (function () {
    let tabs = document.querySelectorAll(".tabs li");
    let tabsContent = document.querySelectorAll(".tab-content");

    let deactvateAllTabs = function () {
      tabs.forEach(function (tab) {
        tab.classList.remove("is-active");
      });
    };

    let hideTabsContent = function () {
      tabsContent.forEach(function (tabContent) {
        tabContent.classList.remove("is-active");
      });
    };

    let activateTabsContent = function (tab) {
      tabsContent[getIndex(tab)].classList.add("is-active");
    };

    let getIndex = function (el) {
      return [...el.parentElement.children].indexOf(el);
    };

    tabs.forEach(function (tab) {
      tab.addEventListener("click", function () {
        deactvateAllTabs();
        hideTabsContent();
        tab.classList.add("is-active");
        activateTabsContent(tab);
      });
    });

    tabs[0].click();
  })();
</script>
<script>
  setInterval(() => {
    $(".liveUpdate").html("").load("/update");
  }, 10000);
</script>

{% endblock %}
